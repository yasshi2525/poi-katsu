# 未実装機能一覧

このファイルでは、現在のリリースでは実装されていない機能について説明します。

## ランキング画面における他プレイヤー得点内訳表示機能

### 機能概要
ランキング画面で他のプレイヤーの詳細を表示する際に、そのプレイヤーがどのような活動でポイントを獲得したかの内訳を表示する機能。

### 現在の制限
- ランキング画面のスコア内訳表示ボタンは**自分のスコアの場合のみ**表示される
- 他プレイヤーの詳細画面では内訳表示ボタンが表示されない
- 他プレイヤーのポイント獲得詳細は確認できない

### 実装が困難な理由

#### 根本的設計問題
現在のマルチプレイヤー通信設計では、以下の制約により他プレイヤーの詳細な得点内訳情報を取得することが困難です：

1. **PointManagerの設計制約**
   - PointManagerの`award*`、`deduct*`系APIはプレイヤーIDを引数に持たない
   - 現在のプレイヤー（`this.gameContext.currentPlayer`）のトランザクションのみ記録
   - 他プレイヤーのポイント獲得詳細は記録されない

2. **メッセージング設計の制約**
   - `scoreUpdate`メッセージは最終スコアのみを含む
   - ポイント獲得の詳細情報（ソース、金額、タイミング等）は含まれない
   - 他プレイヤーの詳細なトランザクション履歴を取得する仕組みがない

3. **データ同期の複雑性**
   - 各プレイヤーのすべてのポイント獲得詳細をリアルタイムで同期する必要
   - ネットワーク帯域とパフォーマンスへの影響
   - データ整合性の保証が困難

### 実装に必要な変更

この機能を実装するには以下の大幅な設計変更が必要です：

1. **PointManager APIの拡張**
   - プレイヤーIDを指定してトランザクションを記録できるAPIの追加
   - 他プレイヤーのトランザクション履歴を管理する仕組み

2. **メッセージング設計の変更**
   - ポイント獲得詳細情報を含む新しいメッセージタイプの追加
   - トランザクション詳細の同期メカニズム

3. **データ管理の見直し**
   - 全プレイヤーのトランザクション履歴を効率的に管理
   - メモリ使用量とネットワーク通信量の最適化

### 代替案

現在のリリースでは以下の代替手段を提供しています：

- **自分のスコア内訳表示**: 自分の詳細な得点内訳を確認可能
- **他プレイヤーの基本情報**: 他プレイヤーの総合スコア、完了タスク数を表示
- **ランキング表示**: 全プレイヤーの順位と総合スコアを比較可能

### 今後の対応

この機能は将来のバージョンで実装を検討する予定ですが、上記の設計制約を解決するための十分な開発時間とテストが必要です。

## ランキング画面における他プレイヤー所持アイテム数表示機能

### 機能概要
ランキング画面で他のプレイヤーの詳細を表示する際に、そのプレイヤーが所持しているアイテム数を表示する機能。

### 現在の制限
- 他プレイヤーの詳細画面では所持アイテム数が表示されない
- 自分の詳細画面でのみ所持アイテム数を確認可能

### 実装が困難な理由

#### アイテム取引同期の制約
現在のマルチプレイヤー通信設計では、以下の制約により他プレイヤーの正確な所持アイテム数を取得することが困難です：

1. **初期同期のみ実装**
   - `playerJoined`メッセージでゲーム開始時の`ownedItems`は同期される
   - しかし、**ゲーム中のアイテム購入・売却は他プレイヤーに同期されない**

2. **アイテム取引メッセージの欠如**
   - ショッピングでのアイテム購入詳細は同期されない
   - フリマでの売買取引は同期されない
   - アイテム取引の詳細な同期メカニズムがない

3. **データ不整合の問題**
   - 他プレイヤーの表示される所持アイテム数は**ゲーム開始時の値から更新されない**
   - 実際の購入・売却が反映されず、不正確な情報を表示してしまう

### 実装に必要な変更

この機能を実装するには以下の設計変更が必要です：

1. **アイテム取引同期メッセージの追加**
   - アイテム購入時の同期メッセージ
   - フリマ売買時の同期メッセージ
   - アイテム数変更の詳細な通知機能

2. **ItemManagerとの連携強化**
   - 他プレイヤーのアイテム状態を管理する仕組み
   - リアルタイムでのアイテム数同期機能

3. **データ整合性の保証**
   - 全プレイヤーのアイテム状態を一貫して管理
   - ネットワーク遅延やエラー時の整合性確保

### 現在の対応

速度を優先したリリースでは以下の方針を採用しています：

- **不正確な情報の表示を避ける**: 他プレイヤーの所持アイテム数は表示しない
- **自分の情報のみ正確に表示**: 自分の所持アイテム数は正確に表示
- **将来の拡張性を考慮**: コード構造は将来の実装に対応可能

### 今後の対応

この機能は将来のバージョンで実装を検討する予定ですが、アイテム取引の詳細な同期メカニズムの設計と実装が必要です。